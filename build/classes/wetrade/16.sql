select s1.CUST_EMAIL,s1.LAST_NAME,s1.REG_DATE,s2.STATUS
from
  (select CUST_EMAIL,LAST_NAME,REG_DATE
    from CUSTOMER, 
      (select v1.CUST_TRANS_EMAIL from
      (select CUST_TRANS_EMAIL, COUNT(*) as count_bi  from CUST_GENERATE_TRANS, TRANSACTION
      where GEN_TRANS_ID = TRANS_ID AND type = 'BI'
      GROUP BY CUST_TRANS_EMAIL)v1,
      (select CUST_TRANS_EMAIL, COUNT(*) as count_pi  from CUST_GENERATE_TRANS, TRANSACTION
      where GEN_TRANS_ID = TRANS_ID AND type = 'PI'
      GROUP BY CUST_TRANS_EMAIL)v2
      where v1.CUST_TRANS_EMAIL = v2.CUST_TRANS_EMAIL AND v1.count_bi > v2.count_pi
      )t1
  WHERE
  T1.CUST_TRANS_EMAIL = CUST_EMAIL)S1
  ,
  (select CUST_EMAIL, 'REGULAR' as STATUS from CUSTOMER
  where CUST_EMAIL NOT IN (select CLASS_EMAIL from CLASSIFIED_CUSTOMER)
  UNION
  select CLASS_EMAIL, 'GOLD' as STATUS  from CLASSIFIED_CUSTOMER, GOLD
  where CLASS_EMAIL = GOLD_EMAIL
  UNION
  select CLASS_EMAIL, 'PLATINUM' as STATUS  from CLASSIFIED_CUSTOMER, PLATINUM
  where CLASS_EMAIL = PLATINUM_EMAIL)S2
where s1.CUST_EMAIL = s2.CUST_EMAIL
order by s1.REG_DATE, s2.STATUS
;